# 服务器清档文档

## 1.关闭服务

- 【1.关闭web后台服务】关闭web后台服务《仅皇家一号需要该步骤》
- 【2.关闭游戏服务】关闭游戏服务

## 2.执行数据清理

### 数据清理脚本

```text
node dist/tools/system/restoreServerToInit.js
```

### 忽略清理的数据项

```text
1、游戏开关；
2、VIP开关；
3、充值通道开关；
4、视讯渠道点数；
5、彩票之前的开奖记录；
6、系统设置；
7、刮刮数据；
```

### 清理数据流程

- 【1.检查忽略项】根据忽略项与实际需求修改需要忽略清理的数据项。
- 【2.清理数据】执行脚本<restoreServerToInit.js>。清除redis数据，清除mongo数据
- 【3.检查清理数据】检查清理数据是否清理完成

## 3.生成机器人

### 添加机器人脚本

```text
node dist/tools/robot/addRobot.js                        //添加机器人脚本
node dist/tools/robot/changeRobotHeadImgLocal.js         //修改机器人头像脚本<使用系统默认头像>
```

### 添加机器人流程

- 【1.检查忽略项】根据根据需求生成机器人数量,默认4000个，可修改。
- 【2.生成机器人】执行脚本<addRobot.js>。生成机器人<默认生成机器人带有头像>。
- 【3.检查机器人】检查机器人是否生成成功
- 【4.修改机器人头像{可选}】执行脚本<changeRobotHeadImgLocal.js>。修改机器人头像。
- 【5.检查机器人头像{可选}】检查机器人头像是否生成成功

## 4.设置游戏房间数量

### 设置游戏房间脚本

```text
node dist/tools/system/addOneGameRoom.js                        //设置游戏房间数量脚本
```

### 设置游戏房间流程

- 【1.添加房间数量】执行脚本<addOneGameRoom.js>。设置游戏房间数量。

## 5.重启服务器

- 【1.重启游戏服务器】重启游戏服务器。
- 【2.重启web服务器】重启web后台服务器。

## 6.游戏测试

### app测试

- 【1.app登录测试】检查app注册登录正确性
- 【2.app充值测试】检查app充值系统正确性
- 【3.app游戏测试】检查app各游戏正确性
- 【4.app必要的其他测试】按需求检查正确性

### h5测试

- 【1.h5登录测试】检查h5注册登录正确性
- 【2.h5充值测试】检查h5充值系统正确性
- 【3.h5游戏测试】检查h5各游戏正确性
- 【4.h5必要的其他测试】按需求检查正确性

### 机器人测试

- 【1.万人类游戏机器人测试】检查万人类游戏中的机器人的下注行为正确性。
- 【2.电玩类游戏机器人测试】检查电玩类游戏中的机器人的正确性（电玩类游戏机器人，无后端逻辑，纯前端模拟）。
- 【3.游戏房间数量检测测试】检查检测游戏房间数量是否正确。

## 清除玩家金币&钱包&充值记录

## 1.关闭服务

- 【1.关闭web后台服务】关闭web后台服务《仅皇家一号需要该步骤》
- 【2.关闭游戏服务】关闭游戏服务

## 2.执行数据清理

### 数据清理脚本

```text
node dist/tools/system/ClearPlayerRecharge.js
```

### 清理的数据项

```text
# redis
    删除：
    real_player_info*
    user_info*
    
# mongo
    修改：
    player_info 
                --->good:{1:0,2:0}
                --->walletGold:0
    删除：
    pay_info
    pay_order

```

## 3.重启服务器

- 【1.重启游戏服务器】重启游戏服务器。
- 【2.重启web服务器】重启web后台服务器。

## 4.游戏测试

- 【1.后台记录测试】检查后台查询玩家数据正确性
- 【2.app玩家属性】检查app玩家的金币和钱包正确性
- 【3.app游戏测试】检查app各游戏正确性
