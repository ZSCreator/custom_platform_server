"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.robotEnterDZ = void 0;
const FCS_Robot_1 = require("./FCS_Robot");
const robotCommonOp_1 = require("../../../../services/robotService/overallController/robotCommonOp");
const pinus_logger_1 = require("pinus-logger");
const GameNidEnum_1 = require("../../../../common/constant/game/GameNidEnum");
const JsonMgr_1 = require("../../../../../config/data/JsonMgr");
const utils = require("../../../../utils");
const robotlogger = (0, pinus_logger_1.getLogger)('robot_out', __filename);
const nid = GameNidEnum_1.GameNidEnum.FiveCardStud;
const FCSRoomMgr_1 = require("../FCSRoomMgr");
function robotEnterDZ(Mode_IO = false) {
    const RoomMgr = FCSRoomMgr_1.default;
    const robotManger = new robotCommonOp_1.default();
    robotManger.registerAddRobotListener(nid, Mode_IO, SingleRobotEnter, RoomMgr.getAllRooms.bind(RoomMgr));
    robotManger.start();
    return robotManger;
}
exports.robotEnterDZ = robotEnterDZ;
;
async function SingleRobotEnter(nid, sceneId, roomId, Mode_IO, player) {
    if (!player) {
        return;
    }
    const FCS_Robot_ = new FCS_Robot_1.default({ Mode_IO, });
    try {
        if (Mode_IO) {
            await FCS_Robot_.enterHall(player, nid);
        }
        else {
            FCS_Robot_.enterHallMode(player, nid);
        }
        FCS_Robot_.setRobotGoldBeforeEnter(nid, sceneId);
        let param = { currGold: 0 };
        const sceneInfo = (0, JsonMgr_1.get)('scenes/FiveCardStud').datas.find(scene => scene.id === sceneId);
        let _arr = [
            { group: 0, weight: 1, min: 1, max: 1 },
            { group: 1, weight: 10, min: 1, max: 5 },
            { group: 2, weight: 10, min: 5, max: 10 },
            { group: 3, weight: 20, min: 10, max: 10 },
            { group: 4, weight: 30, min: 10, max: 15 },
            { group: 5, weight: 20, min: 15, max: 20 },
            { group: 6, weight: 9, min: 20, max: 20 },
        ];
        let group = utils.sortProbability_(_arr);
        const G = sceneInfo.lowBet * 10;
        let min = _arr[group].min * G;
        let max = _arr[group].max * G;
        param.currGold = utils.random(min, max);
        FCS_Robot_.setRobotGoldBeforeEnter(nid, sceneId);
        await FCS_Robot_.enterGameOrSelectionList(nid, sceneId, roomId, param);
        await FCS_Robot_.loaded();
        FCS_Robot_.registerListener();
    }
    catch (error) {
        robotlogger.warn(`FCS.robot ==> |${FCS_Robot_.playerGold}|${JSON.stringify(error)}`);
        FCS_Robot_.destroy();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRkNTX0NvbnRyb2xsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9hcHAvc2VydmVycy9GaXZlQ2FyZFN0dWQvbGliL3JvYm90L0ZDU19Db250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQzs7O0FBS2IsMkNBQW9DO0FBQ3BDLHFHQUF5RztBQUN6RywrQ0FBeUM7QUFDekMsOEVBQTJFO0FBQzNFLGdFQUE2RTtBQUM3RSwyQ0FBNEM7QUFDNUMsTUFBTSxXQUFXLEdBQUcsSUFBQSx3QkFBUyxFQUFDLFdBQVcsRUFBRSxVQUFVLENBQUMsQ0FBQztBQUN2RCxNQUFNLEdBQUcsR0FBRyx5QkFBVyxDQUFDLFlBQVksQ0FBQztBQUVyQyw4Q0FBc0Q7QUFJdEQsU0FBZ0IsWUFBWSxDQUFDLE9BQU8sR0FBRyxLQUFLO0lBQzFDLE1BQU0sT0FBTyxHQUFHLG9CQUFVLENBQUM7SUFDM0IsTUFBTSxXQUFXLEdBQUcsSUFBSSx1QkFBVyxFQUFFLENBQUM7SUFDdEMsV0FBVyxDQUFDLHdCQUF3QixDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsT0FBTyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUN4RyxXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDcEIsT0FBTyxXQUFXLENBQUM7QUFDckIsQ0FBQztBQU5ELG9DQU1DO0FBQUEsQ0FBQztBQUdGLEtBQUssVUFBVSxnQkFBZ0IsQ0FBQyxHQUFXLEVBQUUsT0FBZSxFQUFFLE1BQWMsRUFBRSxPQUFnQixFQUFFLE1BQWU7SUFDN0csSUFBSSxDQUFDLE1BQU0sRUFBRTtRQUNYLE9BQU87S0FDUjtJQUNELE1BQU0sVUFBVSxHQUFHLElBQUksbUJBQVMsQ0FBQyxFQUFFLE9BQU8sR0FBRyxDQUFDLENBQUM7SUFDL0MsSUFBSTtRQUVGLElBQUksT0FBTyxFQUFFO1lBQ1gsTUFBTSxVQUFV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