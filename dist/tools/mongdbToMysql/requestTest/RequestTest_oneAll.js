const payUtilOneAll = require('../../../app/utils/payUtil');
const encryptionOneAll = require('../../../app/common/encryption');
const jsonOneAll = require('../requestTest/test.json');
let SuccessNumOneAll = 0;
let loseNumOneAll = 0;
let allTimeOneAll = 0;
async function cleanOneAll() {
    let accountData = jsonOneAll;
    let num = 10;
    let questList = [];
    for (let i = 0; i < num; i++) {
        let item = accountData[i];
        let timestamp = 1589338001560;
        let agent = item.agent;
        let account = item.account;
        let param = { account: account, KindID: "1", language: 'chinese_zh' };
        let encrpParam = encryptionOneAll.httpUrlEnCryPtionForParam(param);
        let key = encryptionOneAll.MD5KEY(agent, timestamp);
        let body = {
            agent: agent,
            param: encrpParam,
            key: key,
            timestamp: timestamp,
        };
        questList.push(loginOneAll(body));
    }
    await Promise.all(questList);
    console.warn(`总并发请求:${num}, 总耗时：${allTimeOneAll}毫秒, 成功：${SuccessNumOneAll} ,失败：${loseNumOneAll}, 平均耗时：${allTimeOneAll / num}毫秒`);
    process.exit();
}
async function loginOneAll(body) {
    let httpData = {
        parameter: body,
        domainName: "192.168.191.35:3321",
        port: null,
        path: "third/login",
        isJson: null
    };
    const startTime = Date.now();
    const data = await payUtilOneAll.httpPostSendJson(httpData);
    const endTime = Date.now();
    if (data.d.code == 0) {
        SuccessNumOneAll = SuccessNumOneAll + 1;
    }
    else {
        loseNumOneAll = loseNumOneAll + 1;
    }
    allTimeOneAll = endTime - startTime;
}
setTimeout(cleanOneAll, 2000);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVxdWVzdFRlc3Rfb25lQWxsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vdG9vbHMvbW9uZ2RiVG9NeXNxbC9yZXF1ZXN0VGVzdC9SZXF1ZXN0VGVzdF9vbmVBbGwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsTUFBTSxhQUFhLEdBQUksT0FBTyxDQUFDLDRCQUE0QixDQUFDLENBQUM7QUFDN0QsTUFBTSxnQkFBZ0IsR0FBSSxPQUFPLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztBQUNwRSxNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsMEJBQTBCLENBQUMsQ0FBQztBQUN2RCxJQUFJLGdCQUFnQixHQUFHLENBQUMsQ0FBQztBQUN6QixJQUFJLGFBQWEsR0FBRyxDQUFDLENBQUM7QUFDdEIsSUFBSSxhQUFhLEdBQUcsQ0FBQyxDQUFDO0FBQ3RCLEtBQUssVUFBVSxXQUFXO0lBRXRCLElBQUksV0FBVyxHQUFHLFVBQVUsQ0FBQztJQUM3QixJQUFJLEdBQUcsR0FBRyxFQUFFLENBQUM7SUFDYixJQUFJLFNBQVMsR0FBRyxFQUFFLENBQUM7SUFDbkIsS0FBSSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUcsQ0FBQyxHQUFHLEdBQUcsRUFBRyxDQUFDLEVBQUUsRUFBQztRQUMxQixJQUFJLElBQUksR0FBRyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUIsSUFBSSxTQUFTLEdBQUcsYUFBYSxDQUFFO1FBQy9CLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDdkIsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUMzQixJQUFJLEtBQUssR0FBRyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUksTUFBTSxFQUFHLEdBQUcsRUFBRyxRQUFRLEVBQUcsWUFBWSxFQUFFLENBQUM7UUFDM0UsSUFBSSxVQUFVLEdBQUcsZ0JBQWdCLENBQUMseUJBQXlCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDbkUsSUFBSSxHQUFHLEdBQUcsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBQyxTQUFTLENBQUMsQ0FBQztRQUNuRCxJQUFJLElBQUksR0FBRztZQUNQLEtBQUssRUFBRSxLQUFLO1lBQ1osS0FBSyxFQUFFLFVBQVU7WUFDakIsR0FBRyxFQUFHLEdBQUc7WUFDVCxTQUFTLEVBQUcsU0FBUztTQUN4QixDQUFDO1FBQ0YsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQTtLQUNwQztJQUNELE1BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUM5QixPQUFPLENBQUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLGFBQWEsVUFBVSxnQkFBZ0IsUUFBUSxhQUFhLFVBQVUsYUFBYSxHQUFDLEdBQUcsSUFBSSxDQUFDLENBQUE7SUFDOUgsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ25CLENBQUM7QUFLRCxLQUFLLFVBQVcsV0FBVyxDQUFDLElBQVU7SUFDbEMsSUFBSSxRQUFRLEdBQVE7UUFDaEIsU0FBUyxFQUFFLElBQUk7UUFDZixVQUFVLEVBQUUscUJBQXFCO1FBQ2pDLElBQUksRUFBRSxJQUFJO1FBQ1YsSUFBSSxFQUFFLGFBQWE7UUFDbkIsTUFBTSxFQUFFLElBQUk7S0FDZixDQUFBO0lBQ0QsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBQzdCLE1BQU0sSUFBSSxHQUFHLE1BQU0sYUFBYSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzVELE1BQU0sT0FBTyxHQUFJLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUM1QixJQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsRUFBQztRQUNoQixnQkFBZ0IsR0FBRyxnQkFBZ0IsR0FBRyxDQUFDLENBQUM7S0FDM0M7U0FBSTtRQUNELGFBQWEsR0FBRyxhQUFhLEdBQUcsQ0FBQyxDQUFDO0tBQ3JDO0lBQ0QsYUFBYSxHQUFHLE9BQU8sR0FBRyxTQUFTLENBQUM7QUFDeEMsQ0FBQztBQUNELFVBQVUsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUMifQ==