"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const cardTypeUtils = require("../../app/servers/Rummy/robot/cardTypeUtils");
const RummyLogic = require("../../app/servers/Rummy/lib/RummyLogic");
let robotCards = [];
let robotCardList = [];
let pokerList = null;
let firstCard = null;
let loseCard = null;
let lostCards = [];
let winPlayer = 1;
let round = 1;
let needCards = [];
let point = 20;
let changeCard = null;
let changeCardList = [];
let roundList = [];
async function startTest() {
    changeCard = RummyLogic.getChangeCard();
    changeCardList = RummyLogic.getOtherChangeCard(changeCard);
    robotCards = [];
    robotCardList = [];
    pokerList = null;
    firstCard = null;
    loseCard = null;
    lostCards = [];
    winPlayer = 1;
    round = 1;
    needCards = [];
    point = 20;
    const result = RummyLogic.getRobotAndPlayerCards(winPlayer, changeCard, changeCardList);
    robotCards = result.robotCards;
    pokerList = result.pokerList;
    firstCard = result.firstCard;
    console.warn('机器人牌型:', robotCardList, '变牌:', changeCardList, '牌:', robotCards);
    lostCards.push(firstCard);
    const result_1 = cardTypeUtils.robotCardsToCombination(robotCards, changeCardList);
    robotCardList = result_1.cardTypeList;
    needCards = result_1.needCards;
    robotCards = result_1.cards;
    loseCard = result_1.loseCard;
    console.warn('机器人第一次整理牌型:', robotCardList, '变牌:', changeCardList, '需要的牌', needCards);
    point = RummyLogic.calculatePlayerPoint(robotCardList, changeCardList);
    let robotGop = cardTypeUtils.robotGrop(point, robotCards, robotCardList, changeCardList, round);
    if (robotGop) {
        console.warn('机器人弃牌:牌型:', robotCardList, '分数$', point, ',变牌:', changeCardList, '需要的牌', needCards);
    }
    for (let i = 1; i <= 21; i++) {
        if (point == 0) {
            return round;
        }
        else {
            round_fun();
        }
    }
}
function round_fun() {
    let card = getCard();
    robotCards.push(card);
    console.warn('机器人要到牌后的牌:', robotCards, '要牌', card, '变牌', changeCardList, '回合', round);
    const result_2 = cardTypeUtils.robotCardsToCombination(robotCards, changeCardList, card);
    robotCardList = result_2.cardTypeList;
    needCards = result_2.needCards;
    robotCards = result_2.cards;
    loseCard = result_2.loseCard;
    point = RummyLogic.calculatePlayerPoint(robotCardList, changeCardList);
    console.warn('机器人要到牌后整理牌型:', robotCardList, '分数', point, '变牌', changeCardList, '需要的牌', needCards, '丢掉的牌', loseCard);
    let robotGop = cardTypeUtils.robotGrop(point, robotCards, robotCardList, changeCardList, round);
    if (robotGop) {
        console.warn('机器人弃牌:', robotCardList, '分数', point, '变牌', changeCardList);
        return;
    }
    if (point == 0) {
        console.warn('机器人胡牌牌型:', robotCardList, '分数', point, '变牌', changeCardList);
    }
    lostCards.push(loseCard);
    round += 1;
}
function getCard() {
    const result = RummyLogic.getCardForPoker(pokerList, needCards, winPlayer, 2, round, changeCardList);
    return result.card;
}
async function clean() {
    let roundList = [];
    for (let i = 1; i <= 1; i++) {
        const round = await startTest();
        console.warn("round", round);
        roundList.push(round);
    }
    for (let i = 2; i <= 20; i++) {
        if (i < 10) {
            const ls = roundList.filter(x => x == i);
            console.warn(`${i} 回合结束的有${ls.length}局`);
        }
        else if (i > 10 && i < 20) {
            const ls = roundList.filter(x => x >= i);
            console.warn(`${i} 回合结束的有${ls.length}局`);
        }
        else {
            const ls = roundList.filter(x => x >= 20);
            console.warn(`20以上 回合结束的有${ls.length}局`);
        }
    }
    console.warn(Date.now());
    process.exit();
}
setTimeout(clean, 0);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUnVtbXlBSVRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi90b29scy9tb25nZGJUb015c3FsL1J1bW15QUlUZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsNkVBQThFO0FBQzlFLHFFQUF1RTtBQUN2RSxJQUFJLFVBQVUsR0FBRyxFQUFFLENBQUM7QUFDcEIsSUFBSSxhQUFhLEdBQVcsRUFBRSxDQUFDO0FBQy9CLElBQUksU0FBUyxHQUFHLElBQUksQ0FBQztBQUNyQixJQUFJLFNBQVMsR0FBRyxJQUFJLENBQUM7QUFDckIsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDO0FBQ3BCLElBQUksU0FBUyxHQUFHLEVBQUUsQ0FBQztBQUNuQixJQUFJLFNBQVMsR0FBRyxDQUFDLENBQUM7QUFDbEIsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDO0FBQ2QsSUFBSSxTQUFTLEdBQUcsRUFBRSxDQUFDO0FBQ25CLElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQztBQUNmLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQztBQUN0QixJQUFJLGNBQWMsR0FBRyxFQUFFLENBQUM7QUFDeEIsSUFBSSxTQUFTLEdBQUcsRUFBRSxDQUFDO0FBQ25CLEtBQUssVUFBVSxTQUFTO0lBRW5CLFVBQVUsR0FBRyxVQUFVLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDeEMsY0FBYyxHQUFHLFVBQVUsQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUMzRCxVQUFVLEdBQUcsRUFBRSxDQUFDO0lBQ2hCLGFBQWEsR0FBSSxFQUFFLENBQUM7SUFDcEIsU0FBUyxHQUFHLElBQUksQ0FBQztJQUNqQixTQUFTLEdBQUcsSUFBSSxDQUFDO0lBQ2pCLFFBQVEsR0FBRyxJQUFJLENBQUM7SUFDaEIsU0FBUyxHQUFHLEVBQUUsQ0FBQztJQUNmLFNBQVMsR0FBRyxDQUFDLENBQUM7SUFDZCxLQUFLLEdBQUcsQ0FBQyxDQUFDO0lBQ1YsU0FBUyxHQUFHLEVB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